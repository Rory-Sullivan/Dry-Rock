<div class="table-responsive">
  <table class="table table-hover border-bottom">
    <thead>
      <tr>
        <th scope="col" class="position-sticky" style="left: 0">Date</th>
        <th scope="col">
          <div class="text-center">Night <small class="text-muted text-nowrap">(00-06)</small></div>
        </th>
        <th scope="col">
          <div class="text-center">Morning <small class="text-muted text-nowrap">(06-12)</small></div>
        </th>
        <th scope="col">
          <div class="text-center">Afternoon <small class="text-muted text-nowrap">(12-18)</small></div>
        </th>
        <th scope="col">
          <div class="text-center">Evening <small class="text-muted text-nowrap">(18-24)</small></div>
        </th>
        <th scope="col">
          <div class="text-center">Temp. <small class="text-muted text-nowrap">(min / max)</small></div>
        </th>
        <th scope="col">
          <div class="text-center">Wind</div>
        </th>
      </tr>
    </thead>
    <tbody>
      {% for day in days %}
      {% with forecast = forecasts[day] %}
      {% if forecast %}
      {# Remove characters from name that break the modal toggle #}
      <tr {% if day.weekday() in [5, 6] %} class="fw-bolder" {% endif %} data-bs-toggle="modal"
        data-bs-target="#{{ place.name.replace(' ', '').replace('(', '').replace(')', '') }}{{ day }}"
        style="cursor: pointer;">
        <th scope="row" class="position-sticky" style="left: 0">
          <div class="text-nowrap d-inline">
            {{ day.strftime("%a") }} <small class="text-muted d-none d-md-inline">{{ day.strftime("%d %b") }}</small>
          </div>
        </th>

        {% if forecast.night_rain %}
        <td class="text-nowrap text-center table-{{ forecast.night_rain_colour_variant }}">
          {% if forecast.night_rain.units == 'inches' %}
          {{ forecast.night_rain.value | round(2) }} in
          {% else %}
          {{ forecast.night_rain.value | round(1) }} {{forecast.night_rain.units }}
          {% endif %}
        </td>
        {% else %}
        <td></td>
        {% endif %}

        {% if forecast.morning_rain %}
        <td class="text-nowrap text-center table-{{ forecast.morning_rain_colour_variant }}">
          {% if forecast.morning_rain.units == 'inches' %}
          {{ forecast.morning_rain.value | round(2) }} in
          {% else %}
          {{ forecast.morning_rain.value | round(1) }} {{forecast.morning_rain.units }}
          {% endif %}
        </td>
        {% else %}
        <td></td>
        {% endif %}

        {% if forecast.afternoon_rain %}
        <td class="text-nowrap text-center table-{{ forecast.afternoon_rain_colour_variant }}">
          {% if forecast.afternoon_rain.units == 'inches' %}
          {{ forecast.afternoon_rain.value | round(2) }} in
          {% else %}
          {{ forecast.afternoon_rain.value | round(1) }} {{forecast.afternoon_rain.units }}
          {% endif %}
        </td>
        {% else %}
        <td></td>
        {% endif %}

        {% if forecast.evening_rain %}
        <td class="text-nowrap text-center table-{{ forecast.evening_rain_colour_variant }}">
          {% if forecast.evening_rain.units == 'inches' %}
          {{ forecast.evening_rain.value | round(2) }} in
          {% else %}
          {{ forecast.evening_rain.value | round(1) }} {{forecast.evening_rain.units }}
          {% endif %}
        </td>
        {% else %}
        <td></td>
        {% endif %}

        <td class="text-nowrap text-center table-{{ forecast.max_temp_colour_variant }}">
          {{forecast.min_temp.value | round | int }} / {{ forecast.max_temp.value | round | int }}
          {% if forecast.max_temp.units == "celsius" %}
          &deg;C
          {% elif forecast.max_temp.units == "fahrenheit" %}
          &deg;F
          {% else %}
          {{ forecast.max_temp.units }}
          {% endif %}
        </td>
        <td class="text-nowrap text-center table-{{ forecast.max_wind_speed_colour_variant }}">
          {{ forecast.max_wind_speed.value | round | int }} {{ forecast.max_wind_speed.units }} {{
          forecast.max_wind_speed_direction }}
        </td>
      </tr>
      {% endif %}
      {% endwith %}
      {% endfor %}
    </tbody>
  </table>
</div>

{% for day in days %}
{# Remove characters from name that break the modal toggle #}
<div class="modal fade" id="{{ place.name.replace(' ', '').replace('(', '').replace(')', '') }}{{ day }}" tabindex="-1"
  aria-labelledby="{{ place.name }}{{ day }}Label" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="{{ place.name }}{{ day }}Label">{{ place.name }}</h5>
        <h5 class="modal-title ms-auto">{{ day.strftime("%a") }} <small class="text-muted">{{ day.strftime("%d %b")
            }}</small></h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body px-0">
        <table class="table">
          <thead>
            <tr>
              <th scope="col">Time</th>
              <th scope="col">Rain</th>
              <th scope="col">Temp.</th>
              <th scope="col">Wind</th>
            </tr>
          </thead>
          <tbody>
            {% for interval in forecasts[day].intervals %}
            <tr>
              <td class="text-nowrap">
                {{ interval.start_time.strftime("%H")}} - {{ interval.end_time.strftime("%H")}}
              </td>

              <td class="text-nowrap table-{{ interval.rain_colour_variant }}">
                {% if interval.rain.units == 'inches' %}
                {{ interval.rain.value | round(2) }} in
                {% else %}
                {{ interval.rain.value | round(1) }} {{interval.rain.units }}
                {% endif %}
              </td>

              <td class="text-nowrap table-{{ interval.temp_colour_variant }}">
                {{interval.temp.value | round(1) }}
                {% if interval.temp.units == "celsius" %}
                &deg;C
                {% elif interval.temp.units == "fahrenheit" %}
                &deg;F
                {% else %}
                {{ interval.temp.units }}
                {% endif %}
              </td>

              <td class="text-nowrap  table-{{ interval.wind_speed_colour_variant }}">
                {{ interval.wind_speed.value }} {{ interval.wind_speed.units }} {{ interval.wind_from_direction }}
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
{% endfor %}
